2019-04-23 11:13:06,704 - INFO - Beginning execution of dms2_bcsubamp in directory /fh/fast/bloom_j/computational_notebooks/lgentles/2019/2B06_DMS

2019-04-23 11:13:06,705 - INFO - Progress is being logged to ./results/codoncounts/WSN-HA-plasmid.log
2019-04-23 11:13:06,714 - INFO - Version information:
	Time and date: Tue Apr 23 11:13:06 2019
	Platform: Linux-3.13.0-143-generic-x86_64-with-debian-jessie-sid
	Python version: 3.6.7 | packaged by conda-forge | (default, Nov 21 2018, 02:32:25)  [GCC 4.8.2 20140120 (Red Hat 4.8.2-15)]
	dms_tools2 version: 2.4.10
	Bio version: 1.72
	HTSeq version: 0.11.0
	pandas version: 0.24.2
	numpy version: 1.15.4
	IPython version: 7.2.0
	jupyter version: 1.0.0
	matplotlib version: 3.0.2
	plotnine version: 0.5.1
	natsort version: 5.5.0
	pystan version: 2.16.0.0
	scipy version: 1.1.0
	seaborn version: 0.9.0
	phydmslib version: 2.3.1
	statsmodels version: 0.9.0
	rpy2 version: 2.9.1
	regex version: 2.4.153
	umi_tools version: 1.0.0

2019-04-23 11:13:06,714 - INFO - Parsed the following arguments:
	outdir = ./results/codoncounts
	ncpus = -1
	use_existing = yes
	refseq = ./data/WSN-HA.fasta
	alignspecs = ['1,285,36,37', '286,570,31,32', '571,855,37,32', '856,1140,31,36', '1141,1425,29,33', '1426,1698,40,43']
	bclen = 8
	fastqdir = /fh/fast/bloom_j/SR/ngs/illumina/lgentles/190419_M03100_0418_000000000-CCW7R/Data/Intensities/BaseCalls/
	R2 = None
	R1trim = [200]
	R2trim = [170]
	bclen2 = None
	chartype = codon
	maxmuts = 4
	minq = 15
	minreads = 2
	minfraccall = 0.95
	minconcur = 0.75
	sitemask = None
	purgeread = 0
	purgebc = 0
	bcinfo = False
	name = WSN-HA-plasmid
	R1 = ['WSN-HA-plasmid_*_R1_*.fastq.gz']

2019-04-23 11:13:06,751 - INFO - Read refseq of 1698 codons from ./data/WSN-HA.fasta
2019-04-23 11:13:06,756 - INFO - Reads are in these FASTQ pairs:
	/fh/fast/bloom_j/SR/ngs/illumina/lgentles/190419_M03100_0418_000000000-CCW7R/Data/Intensities/BaseCalls/WSN-HA-plasmid_S2_L001_R1_001.fastq.gz and /fh/fast/bloom_j/SR/ngs/illumina/lgentles/190419_M03100_0418_000000000-CCW7R/Data/Intensities/BaseCalls/WSN-HA-plasmid_S2_L001_R2_001.fastq.gz

2019-04-23 11:13:06,756 - INFO - Now parsing read pairs...
2019-04-23 11:13:22,306 - INFO - Reads parsed so far: 500000
2019-04-23 11:13:38,231 - INFO - Reads parsed so far: 1000000
2019-04-23 11:13:54,910 - INFO - Reads parsed so far: 1500000
2019-04-23 11:14:08,346 - INFO - Reads parsed so far: 2000000
2019-04-23 11:14:23,542 - INFO - Reads parsed so far: 2500000
2019-04-23 11:14:38,127 - INFO - Reads parsed so far: 3000000
2019-04-23 11:14:52,137 - INFO - Reads parsed so far: 3500000
2019-04-23 11:15:07,153 - INFO - Reads parsed so far: 4000000
2019-04-23 11:15:21,142 - INFO - Reads parsed so far: 4500000
2019-04-23 11:15:35,011 - INFO - Reads parsed so far: 5000000
2019-04-23 11:15:48,705 - INFO - Reads parsed so far: 5500000
2019-04-23 11:16:02,269 - INFO - Reads parsed so far: 6000000
2019-04-23 11:16:16,411 - INFO - Reads parsed so far: 6500000
2019-04-23 11:16:30,206 - INFO - Reads parsed so far: 7000000
2019-04-23 11:16:44,078 - INFO - Reads parsed so far: 7500000
2019-04-23 11:16:57,464 - INFO - Reads parsed so far: 8000000
2019-04-23 11:17:11,125 - INFO - Reads parsed so far: 8500000
2019-04-23 11:17:24,824 - INFO - Reads parsed so far: 9000000
2019-04-23 11:17:37,289 - INFO - Parsed 9304212 reads, found 1604548 unique barcodes.
2019-04-23 11:17:37,304 - INFO - Summary stats on reads:
   total  fail filter  low Q barcode
 9304212            0         920313
2019-04-23 11:17:37,304 - INFO - Writing these stats to ./results/codoncounts/WSN-HA-plasmid_readstats.csv

2019-04-23 11:17:38,016 - INFO - Number of reads per barcode:
                 number of barcodes
number of reads                    
1                            379969
2                            111412
3                            115334
4                            134019
5                            147079
6                            148315
7                            138556
8                            120270
9                             96938
10                            73677
11                            51776
12                            34917
13                            22308
14                            13633
15                             7545
16                             4260
17                             2298
18                             1119
19                              563
20                              272
21                              149
22                               61
23                               36
24                               14
25                               11
26                                5
27                                3
28                                5
29                                2
30                                1
44                                1
2019-04-23 11:17:38,016 - INFO - Writing these stats to ./results/codoncounts/WSN-HA-plasmid_readsperbc.csv

2019-04-23 11:17:38,022 - INFO - Examining the 1604548 barcodes to build and align subamplicons...
2019-04-23 11:17:52,388 - INFO - Barcodes examined so far: 200000
2019-04-23 11:18:06,100 - INFO - Barcodes examined so far: 400000
2019-04-23 11:18:19,695 - INFO - Barcodes examined so far: 600000
2019-04-23 11:18:33,030 - INFO - Barcodes examined so far: 800000
2019-04-23 11:18:45,066 - INFO - Barcodes examined so far: 1000000
2019-04-23 11:18:55,782 - INFO - Barcodes examined so far: 1200000
2019-04-23 11:19:02,702 - INFO - Barcodes examined so far: 1400000
2019-04-23 11:19:05,098 - INFO - Barcodes examined so far: 1600000
2019-04-23 11:19:05,109 - INFO - Examined all barcodes. Summary stats:
   total  too few reads  not alignable  aligned
 1604548         379969         147963  1076616
2019-04-23 11:19:05,109 - INFO - Writing these stats to ./results/codoncounts/WSN-HA-plasmid_bcstats.csv

2019-04-23 11:19:05,134 - INFO - Writing the counts of each codon identity at each site to ./results/codoncounts/WSN-HA-plasmid_codoncounts.csv

2019-04-23 11:19:05,180 - INFO - Successful completion of dms2_bcsubamp
